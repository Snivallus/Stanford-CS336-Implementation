train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 0.016087661497294903 sec for 8 unique words
_count_pairs: 0.00 sec for 14 unique pairs
_build_heap: 0.00 sec for 14 heap size
_merge: 0.0003699474036693573 sec for 6 merges

train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 12.419433229602873 sec for 59941 unique words
_count_pairs: 0.44 sec for 2080 unique pairs
_build_heap: 0.01 sec for 2080 heap size
_merge: 4.761119754984975 sec for 100 merges


========== cProfile Results (TinyStoriesV2-GPT4-train.txt) ==========
         7876498 function calls in 17.663 seconds

   Ordered by: cumulative time
   List reduced from 286 to 25 due to restriction <25>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.032    0.032   17.663   17.663 train_bpe.py:51(train_bpe)
        1    0.022    0.022   12.418   12.418 train_bpe.py:139(_pretokenize_and_count_mp)
       65    0.001    0.000   11.196    0.172 pool.py:853(next)
       56    0.001    0.000   11.195    0.200 threading.py:295(wait)
      227   11.194    0.049   11.194    0.049 {method 'acquire' of '_thread.lock' objects}
      100    0.003    0.000    4.760    0.048 train_bpe.py:291(_merge_a_pair)
      100    1.720    0.017    4.743    0.047 train_bpe.py:349(_update_pair_count_of_affected_words)
   116371    1.714    0.000    2.605    0.000 train_bpe.py:425(_merge_pair_and_count_pair_difference)
   239814    0.761    0.000    1.074    0.000 __init__.py:660(update)
        1    0.410    0.410    0.443    0.443 train_bpe.py:267(_count_pairs)
   746416    0.334    0.000    0.334    0.000 __init__.py:728(__delitem__)
   968391    0.304    0.000    0.304    0.000 {method 'get' of 'dict' objects}
   239750    0.192    0.000    0.240    0.000 __init__.py:587(__init__)
   116371    0.208    0.000    0.208    0.000 train_bpe.py:470(<listcomp>)
  2377886    0.193    0.000    0.193    0.000 __init__.py:601(__missing__)
   116371    0.131    0.000    0.131    0.000 train_bpe.py:471(<listcomp>)
  1922048    0.126    0.000    0.126    0.000 {built-in method builtins.len}
   762707    0.067    0.000    0.067    0.000 {method 'append' of 'list' objects}
       65    0.000    0.000    0.060    0.001 util.py:208(__call__)
        1    0.000    0.000    0.059    0.059 pool.py:738(__exit__)
        1    0.000    0.000    0.059    0.059 pool.py:654(terminate)
        1    0.000    0.000    0.059    0.059 pool.py:680(_terminate_pool)
        1    0.000    0.000    0.054    0.054 context.py:115(Pool)
        1    0.000    0.000    0.054    0.054 pool.py:183(__init__)
        1    0.000    0.000    0.053    0.053 train_bpe.py:197(find_chunk_boundaries)



train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 84.03196289949119 sec for 6424740 unique words
_count_pairs: 77.37 sec for 16219 unique pairs
_build_heap: 0.03 sec for 16219 heap size
_merge: 738.7519129924476 sec for 100 merges


========== cProfile Results (owt_train.txt) ==========
         972497899 function calls in 911.914 seconds

   Ordered by: cumulative time
   List reduced from 286 to 25 due to restriction <25>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1   11.954   11.954  911.914  911.914 train_bpe.py:51(train_bpe)
      100    0.033    0.000  738.560    7.386 train_bpe.py:291(_merge_a_pair)
      100  282.418    2.824  737.041    7.370 train_bpe.py:349(_update_pair_count_of_affected_words)
 12233143  271.334    0.000  396.294    0.000 train_bpe.py:425(_merge_pair_and_count_pair_difference)
        1    0.671    0.671   84.010   84.010 train_bpe.py:139(_pretokenize_and_count_mp)
        1   73.011   73.011   77.369   77.369 train_bpe.py:267(_count_pairs)
       65    0.001    0.000   53.476    0.823 pool.py:853(next)
       47    0.001    0.000   53.475    1.138 threading.py:295(wait)
      191   53.474    0.280   53.474    0.280 {method 'acquire' of '_thread.lock' objects}
107952088   50.173    0.000   50.173    0.000 __init__.py:728(__delitem__)
 24495478   18.942    0.000   34.666    0.000 __init__.py:660(update)
 12233143   33.416    0.000   33.416    0.000 train_bpe.py:470(<listcomp>)
353163939   28.552    0.000   28.552    0.000 __init__.py:601(__missing__)
 24495414   19.813    0.000   25.193    0.000 __init__.py:587(__init__)
 12233143   21.542    0.000   21.542    0.000 train_bpe.py:471(<listcomp>)
261825357   17.209    0.000   17.209    0.000 {built-in method builtins.len}
 29929476   14.243    0.000   14.243    0.000 {method 'get' of 'dict' objects}
109372015    9.419    0.000    9.419    0.000 {method 'append' of 'list' objects}
 24466452    3.562    0.000    3.562    0.000 {method 'items' of 'dict' objects}
      104    1.491    0.014    1.491    0.014 {function Counter.update at 0x7f255dc520c0}
      100    0.000    0.000    1.481    0.015 __init__.py:721(copy)
       65    0.000    0.000    0.266    0.004 util.py:208(__call__)
        1    0.000    0.000    0.265    0.265 pool.py:738(__exit__)
        1    0.000    0.000    0.265    0.265 pool.py:654(terminate)
        1    0.000    0.000    0.265    0.265 pool.py:680(_terminate_pool)



