train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 0.015645825304090977 sec for 8 unique words
_count_pairs: 0.00 sec for 14 unique pairs
_build_heap: 0.00 sec for 14 heap size
_merge: 0.0002965601161122322 sec for 6 merges

train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 13.000217629596591 sec for 59941 unique words
_count_pairs: 0.44 sec for 2080 unique pairs
_build_heap: 0.01 sec for 2080 heap size
_merge: 4.172203849069774 sec for 100 merges


========== cProfile Results (TinyStoriesV2-GPT4-train.txt) ==========
         7527569 function calls in 17.671 seconds

   Ordered by: cumulative time
   List reduced from 283 to 25 due to restriction <25>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.052    0.052   17.671   17.671 train_bpe.py:36(train_bpe)
        1    0.023    0.023   12.998   12.998 train_bpe.py:124(_pretokenize_and_count_mp)
       65    0.002    0.000   11.933    0.184 pool.py:853(next)
       64    0.001    0.000   11.930    0.186 threading.py:295(wait)
      259   11.929    0.046   11.929    0.046 {method 'acquire' of '_thread.lock' objects}
      100    0.003    0.000    4.171    0.042 train_bpe.py:276(_merge_a_pair)
      100    3.162    0.032    4.154    0.042 train_bpe.py:334(_update_pair_count_of_affected_words)
   239814    0.659    0.000    0.934    0.000 __init__.py:660(update)
        1    0.407    0.407    0.441    0.441 train_bpe.py:252(_count_pairs)
   746416    0.345    0.000    0.345    0.000 __init__.py:728(__delitem__)
   968458    0.264    0.000    0.264    0.000 {method 'get' of 'dict' objects}
   239750    0.200    0.000    0.249    0.000 __init__.py:587(__init__)
  2377886    0.198    0.000    0.198    0.000 __init__.py:601(__missing__)
  1922048    0.126    0.000    0.126    0.000 {built-in method builtins.len}
   762707    0.066    0.000    0.066    0.000 {method 'append' of 'list' objects}
       65    0.000    0.000    0.063    0.001 util.py:208(__call__)
        1    0.000    0.000    0.062    0.062 pool.py:738(__exit__)
        1    0.000    0.000    0.062    0.062 pool.py:654(terminate)
        1    0.001    0.001    0.062    0.062 pool.py:680(_terminate_pool)
        1    0.000    0.000    0.048    0.048 context.py:115(Pool)
        1    0.000    0.000    0.048    0.048 pool.py:183(__init__)
        1    0.000    0.000    0.047    0.047 pool.py:305(_repopulate_pool)
        1    0.002    0.002    0.047    0.047 pool.py:314(_repopulate_pool_static)
       64    0.002    0.000    0.040    0.001 process.py:110(start)
    11971    0.028    0.000    0.038    0.000 max_heapq.py:23(heappush_max)



train_bpe: args = Namespace(max_num_counters=64)
_pretokenize_and_count_words: 85.17884126026183 sec for 6424740 unique words
_count_pairs: 75.93 sec for 16219 unique pairs
_build_heap: 0.03 sec for 16219 heap size
